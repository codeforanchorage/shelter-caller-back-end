{
   "description": "A New Flow",
   "states": [
     {
       "name": "Trigger",
       "type": "InitialState",
       "properties": {
         "offset": {
           "x": -240,
           "y": -890
         },
         "flow_url": "https://webhooks.twilio.com/v1/Accounts/AC092ba853c9fd9010e5f378bf28688949/Flows/FW910c8a5e8e0c73384f3cf490d9cb153b"
       },
       "transitions": [
         {
           "event": "incomingMessage",
           "conditions": [],
           "next": "FF9e858a7a6a524755068ce740d4be32a8",
           "uuid": "4cdd5f7a-22a8-4791-8a82-9370b59417e7"
         },
         {
           "event": "incomingCall",
           "conditions": [],
           "next": "FF2cea504b41c5188ff8dfa8c0ffd886c8",
           "uuid": "74eba450-84c3-4160-9356-4585f4c29423"
         },
         {
           "event": "incomingRequest",
           "conditions": [],
           "next": "FF4bf88042a63554a51f9dae5669705fcc",
           "uuid": "bf908cd7-24ba-4797-bf9a-d8f016d9b3da"
         }
       ],
       "sid": "FFdbf28660c3d2757cfd14fcc1bbcdfddc"
     },
     {
       "name": "Collect",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": 1340,
           "y": 560
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/save_count/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "numberOfPeople",
             "value": "{{widgets.NumberOfBeds.Digits}}"
           },
           {
             "key": "phone",
             "value": "{{flow.variables.contact_phone}}"
           },
           {
             "key": "shelterID",
             "value": "{{flow.variables.shelter_id}}"
           },
           {
             "key": "spokenText",
             "value": "{{widgets.NumberOfBeds.SpeechResult}}"
           },
           {
             "key": "contactType",
             "value": "{{flow.variables.contact_type}}"
           },
           {
             "key": "tries",
             "value": "{{widgets.Collect.parsed.tries}}"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": "FF1b5cd1b74329276dd0287cd85b657165",
           "uuid": "9c6a5887-3db9-4577-8c0c-781ad6bf2ffd"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "3b24866e-ff34-4856-820a-7148c947d580"
         }
       ],
       "sid": "FF128c3d91ab3817b0cfef8f76ddb3e66c"
     },
     {
       "name": "Thanks",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": 1010,
           "y": 1530
         },
         "say": "Your response has been recorded. Thank you for your help. Goodbye.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": null,
           "uuid": "6ac3ef3e-9528-4ab3-9cd6-ca8b4932b85d"
         }
       ],
       "sid": "FF08d5e6b50e862562eb726f9ec1691060"
     },
     {
       "name": "BadInput",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": 1490,
           "y": 60
         },
         "say": "I'm sorry I didn't understand that.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
           "uuid": "f2753cc0-d2b4-4c38-8388-5707fd23f4a0"
         }
       ],
       "sid": "FF6d4d58375f51236a73e50fce82a37842"
     },
     {
       "name": "Greeting",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": 810,
           "y": -120
         },
         "say": "Hello. This is the Anchorage shelter count system.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
           "uuid": "4fefeea7-9a76-4521-9646-ab1b0e15d534"
         }
       ],
       "sid": "FF66b655b9c1c96a42105bf24988a49c70"
     },
     {
       "name": "Understood",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": 1810,
           "y": 820
         },
         "input": "{{widgets.Collect.parsed.success}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF04f68c3abca96bc7cdaa974097cd029b",
           "uuid": "e2529edb-45e0-47be-bf3c-2c94405d165e"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to true",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.Collect.parsed.success}}"
               ],
               "value": "true"
             }
           ],
           "next": "FF553253296b3a0692fa9e73c98e51c528",
           "uuid": "079f419f-c9d3-421d-834e-774d8f0d24c0"
         }
       ],
       "sid": "FF1b5cd1b74329276dd0287cd85b657165"
     },
     {
       "name": "getshelter",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": -1460,
           "y": -20
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/validate_shelter/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "shelterID",
             "value": "{{flow.variables.shelter_id}}"
           },
           {
             "key": "phone",
             "value": "{{contact.channel.address}}"
           },
           {
             "key": "tries",
             "value": "{{widgets.getshelter.parsed.tries}}"
           },
           {
             "key": "contactType",
             "value": "incoming_text"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": "FF5a07160695d29a9918c77cc8f3d5c0fc",
           "uuid": "919ce0d6-8629-40ab-8e62-277a14458be6"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "71107edb-cc12-4f91-afb0-309c43d7ad20"
         }
       ],
       "sid": "FF738e5b761d09d89f0cc6fb87f08a71a8"
     },
     {
       "name": "GoodId",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -1450,
           "y": 280
         },
         "input": "{{widgets.getshelter.parsed.success}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF4dad1612bdca80cdec808c4a2f7c30b4",
           "uuid": "d62a4c7f-d411-42b3-99d9-a566e2f10db9"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to true",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.getshelter.parsed.success}}"
               ],
               "value": "true"
             }
           ],
           "next": "FF1112f81d3a7b756031eab82f1a4ca844",
           "uuid": "68c2ce45-f75e-42d2-a825-2b78628794e2"
         }
       ],
       "sid": "FF5a07160695d29a9918c77cc8f3d5c0fc"
     },
     {
       "name": "AskForID",
       "type": "MessagePrompt",
       "properties": {
         "offset": {
           "x": -2120,
           "y": 330
         },
         "body": "I couldn't find your shelter. Please enter your shelter ID.",
         "from": "{{flow.channel.address}}",
         "timeout": 300,
         "save_response_as": null,
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "incomingMessage",
           "conditions": [],
           "next": "FF78df495d713e48157b5b2e67992f0ecb",
           "uuid": "ff2df8ab-ff1e-4442-90b7-fa1c83f0444f"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": null,
           "uuid": "7ebf6672-31a2-48be-8725-5d70379f914f"
         },
         {
           "event": "deliveryFailure",
           "conditions": [],
           "next": null,
           "uuid": "14853b2d-7c15-4854-a1a3-34ec0f170ab5"
         }
       ],
       "sid": "FF4dad1612bdca80cdec808c4a2f7c30b4"
     },
     {
       "name": "getBeds",
       "type": "MessagePrompt",
       "properties": {
         "offset": {
           "x": -1370,
           "y": 880
         },
         "body": "Great! How many people are in the shelter right now?",
         "from": "{{flow.channel.address}}",
         "timeout": 300,
         "save_response_as": null,
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "incomingMessage",
           "conditions": [],
           "next": "FF153e865579075450bcc2680e319ff928",
           "uuid": "b8c80c69-9d72-48ad-a88f-5a0aba4669f0"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": null,
           "uuid": "89d1aca8-0f16-4b20-b379-98cab56009fb"
         },
         {
           "event": "deliveryFailure",
           "conditions": [],
           "next": null,
           "uuid": "dc43bd74-09e7-49b6-9b68-e449547884a8"
         }
       ],
       "sid": "FFef334fc11d8af4a6cb8c28468b848ead"
     },
     {
       "name": "EndText",
       "type": "Message",
       "properties": {
         "offset": {
           "x": -1550,
           "y": 1650
         },
         "body": "Your response has been recorded. Thank you for your help.",
         "from": "{{flow.channel.address}}",
         "to": "{{contact.channel.address}}",
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "sent",
           "conditions": [],
           "next": null,
           "uuid": "8910431f-1fd0-4fa1-8a98-e88294201278"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "98dad27c-9503-43ab-a906-7603550d620f"
         }
       ],
       "sid": "FFdc9c8ba5a7715641159a76d438724aa7"
     },
     {
       "name": "Answer",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": -270,
           "y": -170
         },
         "say": "Hello, you've reached the Anchorage shelter count system.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": "FF0e97fb28ca824aa7acaac634837bf657",
           "uuid": "8f5178be-4211-41f9-9d7a-e07f7cb94852"
         }
       ],
       "sid": "FF6a0d2610d0eb653b13e350c51c30ccbf"
     },
     {
       "name": "getsheltervoice",
       "type": "Gather",
       "properties": {
         "offset": {
           "x": -150,
           "y": 90
         },
         "timeout": 5,
         "finish_on_key": "#",
         "stop_gather": true,
         "number_of_digits": null,
         "save_response_as": null,
         "say": "Please enter your shelter ID followed by the pound sign.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "hints": null,
         "gather_language": "en-US",
         "speech_timeout": null,
         "speech_model": null,
         "profanity_filter": null
       },
       "transitions": [
         {
           "event": "keypress",
           "conditions": [],
           "next": "FF3194089b9eb9874f1e9284dab3db1e4f",
           "uuid": "928cfaa3-5bc3-4f64-9a22-6dab7c7e0c33"
         },
         {
           "event": "speech",
           "conditions": [],
           "next": null,
           "uuid": "c9bd98dc-1026-47f0-a6a2-e9994c388a92"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": null,
           "uuid": "e5c289ad-86b4-4eda-a3ba-aa56f585b88c"
         }
       ],
       "sid": "FF0e97fb28ca824aa7acaac634837bf657"
     },
     {
       "name": "verify_id_voice",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": -330,
           "y": 460
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/validate_shelter/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "shelterID",
             "value": "{{widgets.getsheltervoice.Digits}}"
           },
           {
             "key": "phone",
             "value": "{{trigger.call.Caller}}"
           },
           {
             "key": "spokenText",
             "value": "{{widgets.getsheltervoice.SpeechResult}}"
           },
           {
             "key": "contactType",
             "value": "incoming_call"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": "FF2f874173f1becb11e8e065230950d5e9",
           "uuid": "c8759e5b-5151-4316-95dc-ab79407a8df6"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "389be8e3-4a7c-4d1a-b785-ceec20c6d8ba"
         }
       ],
       "sid": "FF3194089b9eb9874f1e9284dab3db1e4f"
     },
     {
       "name": "Good_id_voice",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -320,
           "y": 830
         },
         "input": "{{widgets.verify_id_voice.parsed.success}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF3b1015a50e0ea9c3027df95caeb9c2c1",
           "uuid": "830b4ddb-eec6-48c7-8253-ce881f694947"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to true",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.verify_id_voice.parsed.success}}"
               ],
               "value": "true"
             }
           ],
           "next": "FF37ca62a756535106e306b26c23fa23a1",
           "uuid": "4a73ff4f-3790-4009-a48e-8b04a8b05aca"
         }
       ],
       "sid": "FF2f874173f1becb11e8e065230950d5e9"
     },
     {
       "name": "retry_shelter_id_voice",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": -870,
           "y": 400
         },
         "say": "I'm sorry, I could not locate that shelter ID.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": "FF0e97fb28ca824aa7acaac634837bf657",
           "uuid": "f7a4da14-cfa0-4790-abd3-c0ec63505b90"
         }
       ],
       "sid": "FF3b1015a50e0ea9c3027df95caeb9c2c1"
     },
     {
       "name": "Save_count_txt",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": -1630,
           "y": 1130
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/save_count/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "numberOfPeople",
             "value": "{{widgets.getBeds.inbound.Body}}"
           },
           {
             "key": "phone",
             "value": "{{trigger.message.From}}"
           },
           {
             "key": "shelterID",
             "value": "{{widgets.getshelter.parsed.id}}"
           },
           {
             "key": "contactType",
             "value": "incoming_text"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": "FF61b3fbdf3a9728e8c724835a6c3c0028",
           "uuid": "eca8d7ba-3378-4815-b08a-189b003d978e"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "c98fb4a4-5238-4997-8037-009cc4989fbc"
         }
       ],
       "sid": "FF153e865579075450bcc2680e319ff928"
     },
     {
       "name": "valid_count_txt",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -1630,
           "y": 1370
         },
         "input": "{{widgets.Save_count_txt.parsed.success}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF50aa5d7d13d9da3a25e2f29e09df4d24",
           "uuid": "7a109c6c-5023-4e35-8789-990ab69b592c"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to success",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.Save_count_txt.parsed.success}}"
               ],
               "value": "True"
             }
           ],
           "next": "FFdc9c8ba5a7715641159a76d438724aa7",
           "uuid": "30bc5ed9-f18f-4a02-9083-e8c995e04aed"
         }
       ],
       "sid": "FF61b3fbdf3a9728e8c724835a6c3c0028"
     },
     {
       "name": "send_message_2",
       "type": "Message",
       "properties": {
         "offset": {
           "x": -2070,
           "y": 1160
         },
         "body": "I didn't understand that. Please just enter a number.",
         "from": "{{flow.channel.address}}",
         "to": "{{contact.channel.address}}",
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "sent",
           "conditions": [],
           "next": "FFef334fc11d8af4a6cb8c28468b848ead",
           "uuid": "c7601674-f6be-4757-8b76-88e2ca544994"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "e0428515-e479-416f-a77b-931052073784"
         }
       ],
       "sid": "FF50aa5d7d13d9da3a25e2f29e09df4d24"
     },
     {
       "name": "NumberOfBeds",
       "type": "Gather",
       "properties": {
         "offset": {
           "x": 1120,
           "y": 310
         },
         "timeout": 8,
         "finish_on_key": "#",
         "stop_gather": true,
         "number_of_digits": null,
         "save_response_as": null,
         "say": "How many people are in the shelter right now? Please enter the number followed by the pound sign.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "hints": null,
         "gather_language": "en-US",
         "speech_timeout": null,
         "speech_model": null,
         "profanity_filter": null
       },
       "transitions": [
         {
           "event": "keypress",
           "conditions": [],
           "next": "FF128c3d91ab3817b0cfef8f76ddb3e66c",
           "uuid": "0dccd2de-a8fd-449f-8f9f-c1d8271eb753"
         },
         {
           "event": "speech",
           "conditions": [],
           "next": null,
           "uuid": "1e0843d3-f366-4f25-963d-98b33d49cba0"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": "FF5c060974abc7ed8e0e50317a8ae128b2",
           "uuid": "639ca089-7a09-478c-b752-605d0857ff24"
         }
       ],
       "sid": "FFa1935002f30f4ef65c06ad6f1269c63d"
     },
     {
       "name": "LogPhoneBusy",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": 1540,
           "y": -200
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/log_failed_call/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "error",
             "value": "phone_busy"
           },
           {
             "key": "phone",
             "value": "{{flow.variables.contact_phone}}"
           },
           {
             "key": "contactType",
             "value": "outgoing_call"
           },
           {
             "key": "shelterID",
             "value": "{{flow.variables.shelter_id}}"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": null,
           "uuid": "6468c6cb-401b-4495-9a9d-195e98a7e660"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "a7e43b1f-3b6a-4f13-ad97-fad009cca077"
         }
       ],
       "sid": "FF578e7e5da281956ad82efef497eed0d0"
     },
     {
       "name": "LogNoAnswer",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": 1540,
           "y": -440
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/log_failed_call/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "error",
             "value": "no_answer"
           },
           {
             "key": "phone",
             "value": "{{flow.variables.contact_phone}}"
           },
           {
             "key": "contactType",
             "value": "outgoing_call"
           },
           {
             "key": "shelterID",
             "value": "{{flow.variables.shelter_id}}"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": null,
           "uuid": "785bf501-25ff-4d12-8ede-174bb3070484"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "ccc63e37-6076-40f7-88da-892a944dd16f"
         }
       ],
       "sid": "FF723b129ed3ac41ef637eb0c34b695ee8"
     },
     {
       "name": "to_many_tries",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": 2360,
           "y": 350
         },
         "input": "{{widgets.Collect.parsed.tries}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF393202c6967d408cd355f237c4e0143e",
           "uuid": "5aac90ed-42a7-415d-838e-6f4d6e9ff268"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value less_than 3",
               "type": "less_than",
               "arguments": [
                 "{{widgets.Collect.parsed.tries}}"
               ],
               "value": "2"
             }
           ],
           "next": "FF6d4d58375f51236a73e50fce82a37842",
           "uuid": "62770060-1d42-4cfe-a6cf-67ce2d292ab4"
         }
       ],
       "sid": "FF04f68c3abca96bc7cdaa974097cd029b"
     },
     {
       "name": "say_try_bak",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": 2530,
           "y": 840
         },
         "say": "I'm sorry, I'm having trouble understanding. I'll try again later.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": "FFf24b4fbf5e965b65a6025c1a1587523a",
           "uuid": "98682e1d-91fa-4245-b8e8-113f3d8ad12e"
         }
       ],
       "sid": "FF393202c6967d408cd355f237c4e0143e"
     },
     {
       "name": "ConfirmCount",
       "type": "Gather",
       "properties": {
         "offset": {
           "x": 1780,
           "y": 1240
         },
         "timeout": 7,
         "finish_on_key": "#",
         "stop_gather": false,
         "number_of_digits": 1,
         "save_response_as": null,
         "say": "You entered {{widgets.Collect.parsed.count}}. If this is correct, press 1, otherwise press 9 to make a change.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "hints": null,
         "gather_language": "en-US",
         "speech_timeout": null,
         "speech_model": null,
         "profanity_filter": null
       },
       "transitions": [
         {
           "event": "keypress",
           "conditions": [],
           "next": "FF536d80643a4a017661762701544d7a2b",
           "uuid": "7899a693-3693-41f6-94b5-e7ed1b390bd8"
         },
         {
           "event": "speech",
           "conditions": [],
           "next": null,
           "uuid": "10cb4ba3-bcca-4edc-b663-fa6a234c35aa"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": "FF553253296b3a0692fa9e73c98e51c528",
           "uuid": "0c9135ab-7e79-4862-9d9b-3227998176a0"
         }
       ],
       "sid": "FF553253296b3a0692fa9e73c98e51c528"
     },
     {
       "name": "Split_1_or_9",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": 700,
           "y": 730
         },
         "input": "{{widgets.ConfirmCount.Digits}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF553253296b3a0692fa9e73c98e51c528",
           "uuid": "5ac80f31-1398-46dc-b8e1-7580350152b8"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to 9",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.ConfirmCount.Digits}}"
               ],
               "value": "1"
             }
           ],
           "next": "FF08d5e6b50e862562eb726f9ec1691060",
           "uuid": "cc5c6634-eea9-4b06-bb8f-b75afb10433b"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to 9",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.ConfirmCount.Digits}}"
               ],
               "value": "9"
             }
           ],
           "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
           "uuid": "c7879455-7c20-45c6-bf9b-63b62b3b4324"
         }
       ],
       "sid": "FF536d80643a4a017661762701544d7a2b"
     },
     {
       "name": "validate_time_txt",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": -1490,
           "y": -1000
         },
         "method": "GET",
         "url": "http://shelter-caller.appspot.com/twilio/validate_time/",
         "body": null,
         "timeout": null,
         "parameters": null,
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": "FF0d1ddb0868085c128f3416f79665fa2c",
           "uuid": "277a0da3-f329-4faa-b1cf-a8e12f8e7354"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "a3527fdf-99ba-4ac2-99fa-10452ae31780"
         }
       ],
       "sid": "FF9e858a7a6a524755068ce740d4be32a8"
     },
     {
       "name": "open_txt",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -1480,
           "y": -770
         },
         "input": "{{widgets.validate_time_txt.parsed.open}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FFf35c2aa2474151ae6115d971aae29ae0",
           "uuid": "325e7ad0-0e15-4788-b215-44e8775f8b4c"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to true",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.validate_time_txt.parsed.open}}"
               ],
               "value": "true"
             }
           ],
           "next": "FFd6ce67e3e9c142a38a47ae092a97f32f",
           "uuid": "033ad7f8-f0a1-4350-9303-8453bc589c66"
         }
       ],
       "sid": "FF0d1ddb0868085c128f3416f79665fa2c"
     },
     {
       "name": "closed_txt",
       "type": "Message",
       "properties": {
         "offset": {
           "x": -2080,
           "y": -910
         },
         "body": "This service only accepts texts {{widgets.validate_time_txt.parsed.hours}}. Please try again during this time.",
         "from": "{{flow.channel.address}}",
         "to": "{{contact.channel.address}}",
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "sent",
           "conditions": [],
           "next": null,
           "uuid": "855a048f-b474-4a1e-b614-b4842ca9471d"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "69a9673c-ac14-49ba-8fbc-717041d22660"
         }
       ],
       "sid": "FFf35c2aa2474151ae6115d971aae29ae0"
     },
     {
       "name": "validate_time_voice",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": -920,
           "y": -600
         },
         "method": "GET",
         "url": "http://shelter-caller.appspot.com/twilio/validate_time/",
         "body": null,
         "timeout": null,
         "parameters": null,
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": "FFdf9246717a09e08560e79c42e95b48d6",
           "uuid": "074dca9f-eca7-48e2-bcfd-893e76bf521a"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "950d855a-d114-4153-a062-622f4b6e5c3b"
         }
       ],
       "sid": "FF2cea504b41c5188ff8dfa8c0ffd886c8"
     },
     {
       "name": "open_voice",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -500,
           "y": -400
         },
         "input": "{{widgets.validate_time_voice.parsed.open}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF5aef4f759335f3ac5a541af9e784535c",
           "uuid": "3eedc22f-f211-4c6e-8d4b-97db577873ae"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to true",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.validate_time_voice.parsed.open}}"
               ],
               "value": "true"
             }
           ],
           "next": "FF6a0d2610d0eb653b13e350c51c30ccbf",
           "uuid": "42e1e415-83ae-4bbb-a508-68b6b2518e61"
         }
       ],
       "sid": "FF800b7b7d46a438c30a77a989118d42ab"
     },
     {
       "name": "closed_voice",
       "type": "SayPlay",
       "properties": {
         "offset": {
           "x": -1030,
           "y": -310
         },
         "say": "Hello. This service only accepts input  {{widgets.validate_time_voice.parsed.spoken_hours}}. \n\nPlease call back during these hours.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "digits": null
       },
       "transitions": [
         {
           "event": "audioComplete",
           "conditions": [],
           "next": null,
           "uuid": "af0c9e8f-08da-42bc-8ddb-a5c51d11b150"
         }
       ],
       "sid": "FF5aef4f759335f3ac5a541af9e784535c"
     },
     {
       "name": "shelter_id",
       "type": "SetVariables",
       "properties": {
         "offset": {
           "x": 580,
           "y": -880
         },
         "variables": [
           {
             "value": "{{flow.data.id}}",
             "key": "shelter_id"
           },
           {
             "key": "contact_phone",
             "value": "{{contact.channel.address}}",
             "index": "1"
           },
           {
             "key": "contact_type",
             "value": "outgoing_call"
           }
         ]
       },
       "transitions": [
         {
           "event": "next",
           "conditions": [],
           "next": "FFe577883d7fcbfc47a82e4c7457690fba",
           "uuid": "45d86f2c-bd04-4344-baec-da539a351c4e"
         }
       ],
       "sid": "FF4bf88042a63554a51f9dae5669705fcc"
     },
     {
       "name": "Set_shelter_id_incoming",
       "type": "SetVariables",
       "properties": {
         "offset": {
           "x": 250,
           "y": 370
         },
         "variables": [
           {
             "value": "{{widgets.verify_id_voice.parsed.id}}",
             "key": "shelter_id",
             "index": "0"
           }
         ]
       },
       "transitions": [
         {
           "event": "next",
           "conditions": [],
           "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
           "uuid": "30613507-e639-4dae-b0f5-c243f414838f"
         }
       ],
       "sid": "FF18c57c42d940ae284f3669846abb4aaf"
     },
     {
       "name": "Incoming_from",
       "type": "SetVariables",
       "properties": {
         "offset": {
           "x": -260,
           "y": -620
         },
         "variables": [
           {
             "key": "contact_phone",
             "value": "{{trigger.call.Caller}}",
             "index": "0"
           },
           {
             "key": "contact_type",
             "value": "incoming_call"
           }
         ]
       },
       "transitions": [
         {
           "event": "next",
           "conditions": [],
           "next": "FF800b7b7d46a438c30a77a989118d42ab",
           "uuid": "d2edf320-0b00-4a06-b226-2e78f12ed0c6"
         }
       ],
       "sid": "FFdf9246717a09e08560e79c42e95b48d6"
     },
     {
       "name": "verify_shelter_text",
       "type": "MessagePrompt",
       "properties": {
         "offset": {
           "x": -1710,
           "y": 580
         },
         "body": "Hello. Are you submitting counts for {{widgets.getshelter.parsed.name}}?  (Reply yes or no)",
         "from": "{{flow.channel.address}}",
         "timeout": 3600,
         "save_response_as": null,
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "incomingMessage",
           "conditions": [],
           "next": "FF77ba79e929a35ee5373fce7a731ecf29",
           "uuid": "cd648089-4e64-4b2c-b557-bd2f202168cb"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": null,
           "uuid": "d7db0555-cf66-448e-851d-90d7381edfe6"
         },
         {
           "event": "deliveryFailure",
           "conditions": [],
           "next": null,
           "uuid": "dbd312b4-c5d6-4cb7-966c-cc2a181ad1c7"
         }
       ],
       "sid": "FF1112f81d3a7b756031eab82f1a4ca844"
     },
     {
       "name": "split_1",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -2170,
           "y": 820
         },
         "input": "{{widgets.verify_shelter_text.inbound.Body}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF3f592e7076e174e55f5e2786828a75ef",
           "uuid": "d137887f-f66c-4225-b2fa-b0ddac322a50"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value matches_any_of \"yes\", \"Yes\", ",
               "type": "matches_any_of",
               "arguments": [
                 "{{widgets.verify_shelter_text.inbound.Body}}"
               ],
               "value": "yes,y,yup"
             }
           ],
           "next": "FFef334fc11d8af4a6cb8c28468b848ead",
           "uuid": "22ca5cba-0919-4e06-adc5-d8b19fa4b027"
         }
       ],
       "sid": "FF77ba79e929a35ee5373fce7a731ecf29"
     },
     {
       "name": "AskForNewID",
       "type": "MessagePrompt",
       "properties": {
         "offset": {
           "x": -2490,
           "y": 260
         },
         "body": "Okay, please enter your shelter ID.",
         "from": "{{flow.channel.address}}",
         "timeout": 300,
         "save_response_as": null,
         "media_url": null,
         "service": "{{trigger.message.InstanceSid}}",
         "channel": "{{trigger.message.ChannelSid}}",
         "attributes": null
       },
       "transitions": [
         {
           "event": "incomingMessage",
           "conditions": [],
           "next": "FFe948f4c8fc23e6ccc6228b7e5e7f5d24",
           "uuid": "eb6eaab1-091c-41c1-8d5b-65d0b0ce783c"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": null,
           "uuid": "4a99cc66-22bd-4305-bcd3-91a9fe6a3d57"
         },
         {
           "event": "deliveryFailure",
           "conditions": [],
           "next": null,
           "uuid": "1b1ebbe2-696d-4870-a32a-da3713aee21f"
         }
       ],
       "sid": "FF3f592e7076e174e55f5e2786828a75ef"
     },
     {
       "name": "set_shelter_id",
       "type": "SetVariables",
       "properties": {
         "offset": {
           "x": -1410,
           "y": -530
         },
         "variables": [
           {
             "key": "shelter_id",
             "value": "{{trigger.message.Body}}",
             "index": "0"
           }
         ]
       },
       "transitions": [
         {
           "event": "next",
           "conditions": [],
           "next": "FF738e5b761d09d89f0cc6fb87f08a71a8",
           "uuid": "da7c7bbc-3355-4093-b5af-a3b0cfd000f1"
         }
       ],
       "sid": "FFd6ce67e3e9c142a38a47ae092a97f32f"
     },
     {
       "name": "reset_shelter_id",
       "type": "SetVariables",
       "properties": {
         "offset": {
           "x": -2220,
           "y": -410
         },
         "variables": [
           {
             "key": "shelter_id",
             "value": "{{widgets.AskForNewID.inbound.Body}}",
             "index": "0"
           }
         ]
       },
       "transitions": [
         {
           "event": "next",
           "conditions": [],
           "next": "FF738e5b761d09d89f0cc6fb87f08a71a8",
           "uuid": "bde1dfde-6aad-43db-9b45-171a2e73465a"
         }
       ],
       "sid": "FFe948f4c8fc23e6ccc6228b7e5e7f5d24"
     },
     {
       "name": "reset_shelter_id2",
       "type": "SetVariables",
       "properties": {
         "offset": {
           "x": -2240,
           "y": -50
         },
         "variables": [
           {
             "key": "shelter_id",
             "value": "{{widgets.AskForID.inbound.Body}}",
             "index": "0"
           }
         ]
       },
       "transitions": [
         {
           "event": "next",
           "conditions": [],
           "next": "FF738e5b761d09d89f0cc6fb87f08a71a8",
           "uuid": "009c906f-d674-46f8-8e73-44556ca4ad57"
         }
       ],
       "sid": "FF78df495d713e48157b5b2e67992f0ecb"
     },
     {
       "name": "confirm_shelter_id",
       "type": "Gather",
       "properties": {
         "offset": {
           "x": -360,
           "y": 1220
         },
         "timeout": 7,
         "finish_on_key": "#",
         "stop_gather": false,
         "number_of_digits": 1,
         "save_response_as": null,
         "say": "You are submitting the count for {{widgets.verify_id_voice.parsed.name}}. If this is correct, press 1, otherwise press 9 to make a change.",
         "play": null,
         "voice": "Polly.Joanna",
         "language": "en-US",
         "loop": 1,
         "hints": null,
         "gather_language": "en-US",
         "speech_timeout": null,
         "speech_model": null,
         "profanity_filter": null
       },
       "transitions": [
         {
           "event": "keypress",
           "conditions": [],
           "next": "FF387bf581f2f42a6af53466df784e0a50",
           "uuid": "099cd242-c70e-4a23-8e15-e810d0fb274a"
         },
         {
           "event": "speech",
           "conditions": [],
           "next": null,
           "uuid": "c9bcb76d-f14c-4ab4-b8bb-992195fa4856"
         },
         {
           "event": "timeout",
           "conditions": [],
           "next": null,
           "uuid": "d3b19460-1d21-4e62-ac03-ddd35233daca"
         }
       ],
       "sid": "FF37ca62a756535106e306b26c23fa23a1"
     },
     {
       "name": "split_1_9_confirm_shelter",
       "type": "Branch",
       "properties": {
         "offset": {
           "x": -320,
           "y": 1500
         },
         "input": "{{widgets.confirm_shelter_id.Digits}}"
       },
       "transitions": [
         {
           "event": "noMatch",
           "conditions": [],
           "next": "FF0e97fb28ca824aa7acaac634837bf657",
           "uuid": "0b725bc7-dab6-4b16-8785-7597c761cf3c"
         },
         {
           "event": "match",
           "conditions": [
             {
               "friendly_name": "If value equal_to 1",
               "type": "equal_to",
               "arguments": [
                 "{{widgets.confirm_shelter_id.Digits}}"
               ],
               "value": "1"
             }
           ],
           "next": "FF18c57c42d940ae284f3669846abb4aaf",
           "uuid": "eb261afb-3eea-4cc6-b596-46a26315beab"
         }
       ],
       "sid": "FF387bf581f2f42a6af53466df784e0a50"
     },
     {
       "name": "NoUserInput",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": 1650,
           "y": 330
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/log_failed_call/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "error",
             "value": "no_user_input"
           },
           {
             "key": "phone",
             "value": "{{flow.variables.contact_phone}}"
           },
           {
             "key": "contactType",
             "value": "{{flow.variables.contact_type}}"
           },
           {
             "key": "shelterID",
             "value": "{{flow.variables.shelter_id}}"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": null,
           "uuid": "3bc51f5f-94df-4fca-aad1-9aa8dccbb8de"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "191dd5af-1814-41d4-984a-450d5374b1fd"
         }
       ],
       "sid": "FF5c060974abc7ed8e0e50317a8ae128b2"
     },
     {
       "name": "Log_give_up",
       "type": "Webhook",
       "properties": {
         "offset": {
           "x": 2470,
           "y": 1150
         },
         "method": "POST",
         "url": "http://shelter-caller.appspot.com/twilio/log_failed_call/",
         "body": null,
         "timeout": null,
         "parameters": [
           {
             "key": "error",
             "value": "could_not_understand"
           },
           {
             "key": "phone",
             "value": "{{flow.variables.contact_phone}}"
           },
           {
             "key": "contactType",
             "value": "{{flow.variables.contact_type}}"
           },
           {
             "key": "shelterID",
             "value": "{{flow.variables.shelter_id}}"
           }
         ],
         "save_response_as": null,
         "content_type": "application/x-www-form-urlencoded;charset=utf-8"
       },
       "transitions": [
         {
           "event": "success",
           "conditions": [],
           "next": null,
           "uuid": "d53076fa-95a5-45ca-a225-37f9439e83d6"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": null,
           "uuid": "c1e1bb92-5515-49e3-b43b-a77d5771befb"
         }
       ],
       "sid": "FFf24b4fbf5e965b65a6025c1a1587523a"
     },
     {
       "name": "call_user",
       "type": "DialV2",
       "properties": {
         "offset": {
           "x": 1000,
           "y": -550
         },
         "from": "{{flow.channel.address}}",
         "to": "{{contact.channel.address}}",
         "record": false,
         "recording_channels": "mono",
         "recording_status_callback": null,
         "trim": "do-not-trim",
         "detect_answering_machine": false,
         "machine_detection": "Enable",
         "machine_detection_timeout": "30",
         "machine_detection_speech_threshold": "2400",
         "machine_detection_speech_end_threshold": "1200",
         "machine_detection_silence_timeout": "5000",
         "send_digits": null,
         "timeout": 30,
         "sip_auth_username": null,
         "sip_auth_password": null
       },
       "transitions": [
         {
           "event": "answered",
           "conditions": [],
           "next": "FF66b655b9c1c96a42105bf24988a49c70",
           "uuid": "efc0ca82-3d6b-4e04-99d2-f6ba7ece8bf6"
         },
         {
           "event": "busy",
           "conditions": [],
           "next": "FF578e7e5da281956ad82efef497eed0d0",
           "uuid": "3d0a790c-63f2-4769-8b62-67c113b9ef61"
         },
         {
           "event": "noAnswer",
           "conditions": [],
           "next": "FF723b129ed3ac41ef637eb0c34b695ee8",
           "uuid": "7c86aeca-56ff-4a39-ac10-be1ce9cf4e35"
         },
         {
           "event": "failed",
           "conditions": [],
           "next": "FF723b129ed3ac41ef637eb0c34b695ee8",
           "uuid": "33d9ce51-1c10-48f5-ac03-feebcde5fd37"
         }
       ],
       "sid": "FFe577883d7fcbfc47a82e4c7457690fba"
     }
   ]
 }