{
  "description": "A New Flow",
  "states": [
    {
      "type": "InitialState",
      "name": "Trigger",
      "properties": {
        "offset": {
          "x": -240,
          "y": -890
        },
        "flow_url": "https://webhooks.twilio.com/v1/Accounts/AC6f163c4d02441439ceccf8bf753a293e/Flows/FWb68ff38c757c2ebafc3e986c9771b5c2"
      },
      "transitions": [
        {
          "event": "incomingMessage",
          "conditions": [],
          "next": "FF9e858a7a6a524755068ce740d4be32a8",
          "uuid": "441dd9ab-0cbd-4ee7-9d0d-0dc926af89a4"
        },
        {
          "event": "incomingCall",
          "conditions": [],
          "next": "FF2cea504b41c5188ff8dfa8c0ffd886c8",
          "uuid": "4db9be32-bb0d-4506-b3e4-6ded73a18cba"
        },
        {
          "event": "incomingRequest",
          "conditions": [],
          "next": "FF4bf88042a63554a51f9dae5669705fcc",
          "uuid": "e5b62bdd-b1cb-4b90-8863-9f84436c8c06"
        }
      ],
      "sid": "FFdbf28660c3d2757cfd14fcc1bbcdfddc"
    },
    {
      "type": "Dial",
      "name": "Call",
      "properties": {
        "offset": {
          "x": 860,
          "y": -660
        },
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "record": false,
        "timeout": 25
      },
      "transitions": [
        {
          "event": "answered",
          "conditions": [],
          "next": "FF66b655b9c1c96a42105bf24988a49c70",
          "uuid": "8a5e86ba-e81c-456d-9b6f-1b4209991b9d"
        },
        {
          "event": "answeredByMachine",
          "conditions": [],
          "next": "FF578e7e5da281956ad82efef497eed0d0",
          "uuid": "5217900d-6db9-424d-84d9-c4730672fbc4"
        },
        {
          "event": "busy",
          "conditions": [],
          "next": null,
          "uuid": "36a4972d-f9d0-4a4c-a8d1-66cb6120d55e"
        },
        {
          "event": "noAnswer",
          "conditions": [],
          "next": "FF723b129ed3ac41ef637eb0c34b695ee8",
          "uuid": "6c5bf085-cd22-4bde-bbe1-37258265c784"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": "FF723b129ed3ac41ef637eb0c34b695ee8",
          "uuid": "353198ba-a8c1-4fad-bc51-90345609b07e"
        }
      ],
      "sid": "FF70e060531dc1c1d1ce8c9dff29736c57"
    },
    {
      "type": "Webhook",
      "name": "Collect",
      "properties": {
        "offset": {
          "x": 750,
          "y": 450
        },
        "method": "POST",
        "url": "http://shelter-caller.appspot.com/twilio/save_count/",
        "body": null,
        "timeout": null,
        "parameters": [
          {
            "key": "numberOfPeople",
            "value": "{{widgets.NumberOfBeds.Digits}}"
          },
          {
            "key": "phone",
            "value": "{{widgets.Call.To}}"
          },
          {
            "key": "shelterID",
            "value": "{{flow.variables.shelter_id}}"
          },
          {
            "key": "spokenText",
            "value": "{{widgets.NumberOfBeds.SpeechResult}}"
          },
          {
            "key": "contactType",
            "value": "outgoing_call"
          },
          {
            "key": "tries",
            "value": "{{widgets.Collect.parsed.tries}}"
          }
        ],
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF1b5cd1b74329276dd0287cd85b657165",
          "uuid": "b35f160a-79f3-4224-853c-d48bd45b8063"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "e17d5c90-188d-4bee-96e3-c34cdbbd19d9"
        }
      ],
      "sid": "FF128c3d91ab3817b0cfef8f76ddb3e66c"
    },
    {
      "type": "SayPlay",
      "name": "Thanks",
      "properties": {
        "offset": {
          "x": -160,
          "y": 1070
        },
        "say": "Your response has been recorded. Thank you for your help. Goodbye.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": null,
          "uuid": "3acf6588-55f0-4299-ac0f-5a93ae17d39d"
        }
      ],
      "sid": "FF08d5e6b50e862562eb726f9ec1691060"
    },
    {
      "type": "SayPlay",
      "name": "BadInput",
      "properties": {
        "offset": {
          "x": 1320,
          "y": 70
        },
        "say": "I'm sorry I didn't understand that.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
          "uuid": "ca7eb48d-ddf5-41b6-bbb3-baf9573fa4f9"
        }
      ],
      "sid": "FF6d4d58375f51236a73e50fce82a37842"
    },
    {
      "type": "SayPlay",
      "name": "Greeting",
      "properties": {
        "offset": {
          "x": 790,
          "y": -340
        },
        "say": "Hello. This is the Anchorage shelter count system.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
          "uuid": "78edd8b5-eb48-4e42-8996-3d8baecd9cdc"
        }
      ],
      "sid": "FF66b655b9c1c96a42105bf24988a49c70"
    },
    {
      "type": "Branch",
      "name": "Understood",
      "properties": {
        "offset": {
          "x": 810,
          "y": 740
        },
        "input": "{{widgets.Collect.parsed.success}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF04f68c3abca96bc7cdaa974097cd029b",
          "uuid": "a5f58010-f969-4484-8ba1-6c25680fad78"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to true",
              "type": "equal_to",
              "arguments": [
                "{{widgets.Collect.parsed.success}}"
              ],
              "value": "true"
            }
          ],
          "next": "FF553253296b3a0692fa9e73c98e51c528",
          "uuid": "73c4ed82-39b0-40db-ba65-fba8ab6df462"
        }
      ],
      "sid": "FF1b5cd1b74329276dd0287cd85b657165"
    },
    {
      "type": "Webhook",
      "name": "getshelter",
      "properties": {
        "offset": {
          "x": -1560,
          "y": -470
        },
        "method": "POST",
        "url": "http://shelter-caller.appspot.com/twilio/validate_shelter/",
        "body": null,
        "timeout": null,
        "parameters": [
          {
            "key": "shelterID",
            "value": "{{trigger.message.Body}}"
          },
          {
            "key": "phone",
            "value": "{{contact.channel.address}}"
          },
          {
            "key": "shelterID_retry",
            "value": "{{widgets.AskForID.inbound.Body}}"
          },
          {
            "key": "tries",
            "value": "{{widgets.getshelter.parsed.tries}}"
          },
          {
            "key": "contactType",
            "value": "incoming_text"
          }
        ],
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF5a07160695d29a9918c77cc8f3d5c0fc",
          "uuid": "91474926-a821-4747-ba6a-dde165248470"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "1784b818-faad-4283-b1a8-3b8b6cafefb6"
        }
      ],
      "sid": "FF738e5b761d09d89f0cc6fb87f08a71a8"
    },
    {
      "type": "Branch",
      "name": "GoodId",
      "properties": {
        "offset": {
          "x": -1550,
          "y": -160
        },
        "input": "{{widgets.getshelter.parsed.success}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF4dad1612bdca80cdec808c4a2f7c30b4",
          "uuid": "fe1ddc5b-680a-44ed-867d-60bbde8cb621"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to true",
              "type": "equal_to",
              "arguments": [
                "{{widgets.getshelter.parsed.success}}"
              ],
              "value": "true"
            }
          ],
          "next": "FFef334fc11d8af4a6cb8c28468b848ead",
          "uuid": "8f9b468f-629b-4c8e-aa13-061961514998"
        }
      ],
      "sid": "FF5a07160695d29a9918c77cc8f3d5c0fc"
    },
    {
      "type": "MessagePrompt",
      "name": "AskForID",
      "properties": {
        "offset": {
          "x": -1970,
          "y": -310
        },
        "body": "I couldn't find your shelter. Please enter your shelter ID.",
        "from": "{{flow.channel.address}}",
        "timeout": 3600,
        "save_response_as": null,
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "incomingMessage",
          "conditions": [],
          "next": "FF738e5b761d09d89f0cc6fb87f08a71a8",
          "uuid": "07c4294a-e80b-4ab3-97e4-865c0e49f401"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": null,
          "uuid": "a094305d-7773-42f5-ac6c-0dc620f6507b"
        },
        {
          "event": "deliveryFailure",
          "conditions": [],
          "next": null,
          "uuid": "c73e705f-e6be-469a-9c52-78955ddda01c"
        }
      ],
      "sid": "FF4dad1612bdca80cdec808c4a2f7c30b4"
    },
    {
      "type": "MessagePrompt",
      "name": "getBeds",
      "properties": {
        "offset": {
          "x": -1390,
          "y": 150
        },
        "body": "How many people are in the shelter right now?",
        "from": "{{flow.channel.address}}",
        "timeout": 3600,
        "save_response_as": null,
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "incomingMessage",
          "conditions": [],
          "next": "FF153e865579075450bcc2680e319ff928",
          "uuid": "673feaee-96ef-40af-9a91-f52a6113f367"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": null,
          "uuid": "24d2c78f-0f2a-42ce-9fe1-e5bbe7d8fcee"
        },
        {
          "event": "deliveryFailure",
          "conditions": [],
          "next": null,
          "uuid": "5858ebee-a3be-4a44-8868-e5ed3911f75b"
        }
      ],
      "sid": "FFef334fc11d8af4a6cb8c28468b848ead"
    },
    {
      "type": "Message",
      "name": "EndText",
      "properties": {
        "offset": {
          "x": -1570,
          "y": 1010
        },
        "body": "Your response has been recorded, Thank you for your help.",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "sent",
          "conditions": [],
          "next": null,
          "uuid": "23af4264-6bf8-4509-b133-9df8aeca6f2f"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "e31826ff-a537-49e9-b496-81b6dbf0a0d5"
        }
      ],
      "sid": "FFdc9c8ba5a7715641159a76d438724aa7"
    },
    {
      "type": "SayPlay",
      "name": "Answer",
      "properties": {
        "offset": {
          "x": 30,
          "y": -280
        },
        "say": "Hello, you've reached the Anchorage shelter count system.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": "FF0e97fb28ca824aa7acaac634837bf657",
          "uuid": "8ede9df5-07a9-466d-9262-41aff43f9c8c"
        }
      ],
      "sid": "FF6a0d2610d0eb653b13e350c51c30ccbf"
    },
    {
      "type": "Gather",
      "name": "getsheltervoice",
      "properties": {
        "offset": {
          "x": -630,
          "y": 10
        },
        "timeout": 5,
        "finish_on_key": "#",
        "stop_gather": true,
        "number_of_digits": null,
        "save_response_as": null,
        "say": "Please enter your shelter ID followed by the pound sign.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "hints": null,
        "gather_language": "en-US"
      },
      "transitions": [
        {
          "event": "keypress",
          "conditions": [],
          "next": "FF3194089b9eb9874f1e9284dab3db1e4f",
          "uuid": "cd7e0d38-e86a-4ea4-8cf5-098af2d8abfd"
        },
        {
          "event": "speech",
          "conditions": [],
          "next": null,
          "uuid": "dfc7cfee-78f6-4cc3-ac39-d8c605f34365"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": null,
          "uuid": "c441de76-02d6-412a-baf3-3196b45902af"
        }
      ],
      "sid": "FF0e97fb28ca824aa7acaac634837bf657"
    },
    {
      "type": "Webhook",
      "name": "verify_id_voice",
      "properties": {
        "offset": {
          "x": -590,
          "y": 300
        },
        "method": "POST",
        "url": "http://shelter-caller.appspot.com/twilio/validate_shelter/",
        "body": null,
        "timeout": null,
        "parameters": [
          {
            "key": "shelterID",
            "value": "{{widgets.getsheltervoice.Digits}}"
          },
          {
            "key": "phone",
            "value": "{{trigger.call.Caller}}"
          },
          {
            "key": "spokenText",
            "value": "{{widgets.getsheltervoice.SpeechResult}}"
          },
          {
            "key": "contactType",
            "value": "incoming_call"
          }
        ],
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF2f874173f1becb11e8e065230950d5e9",
          "uuid": "9c036024-ad26-4f65-9b32-59d1362caaba"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "799086ab-fe30-4c5d-81bf-2f347134de7b"
        }
      ],
      "sid": "FF3194089b9eb9874f1e9284dab3db1e4f"
    },
    {
      "type": "Branch",
      "name": "Good_id_voice",
      "properties": {
        "offset": {
          "x": -650,
          "y": 510
        },
        "input": "{{widgets.verify_id_voice.parsed.success}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF3b1015a50e0ea9c3027df95caeb9c2c1",
          "uuid": "001f40ae-f9c9-44cc-b2dd-02a51bece4c4"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to true",
              "type": "equal_to",
              "arguments": [
                "{{widgets.verify_id_voice.parsed.success}}"
              ],
              "value": "true"
            }
          ],
          "next": "FF18c57c42d940ae284f3669846abb4aaf",
          "uuid": "f58adc33-e36c-428e-9fd2-22994b19f3b7"
        }
      ],
      "sid": "FF2f874173f1becb11e8e065230950d5e9"
    },
    {
      "type": "SayPlay",
      "name": "retry_shelter_id_voice",
      "properties": {
        "offset": {
          "x": -970,
          "y": 180
        },
        "say": "I'm sorry, I could not locate that shelter ID.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": "FF0e97fb28ca824aa7acaac634837bf657",
          "uuid": "f3ed764e-c579-46ca-90fc-58108b00e3d1"
        }
      ],
      "sid": "FF3b1015a50e0ea9c3027df95caeb9c2c1"
    },
    {
      "type": "Webhook",
      "name": "Save_count_txt",
      "properties": {
        "offset": {
          "x": -1660,
          "y": 410
        },
        "method": "POST",
        "url": "http://shelter-caller.appspot.com/twilio/save_count/",
        "body": null,
        "timeout": null,
        "parameters": [
          {
            "key": "numberOfPeople",
            "value": "{{widgets.getBeds.inbound.Body}}"
          },
          {
            "key": "phone",
            "value": "{{trigger.message.From}}"
          },
          {
            "key": "shelterID",
            "value": "{{widgets.getshelter.parsed.id}}"
          },
          {
            "key": "contactType",
            "value": "incoming_text"
          }
        ],
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF61b3fbdf3a9728e8c724835a6c3c0028",
          "uuid": "822c8b06-629e-4c70-bb49-006edff36fca"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "da8d2d48-3255-4e12-a678-871351df2981"
        }
      ],
      "sid": "FF153e865579075450bcc2680e319ff928"
    },
    {
      "type": "Branch",
      "name": "valid_count_txt",
      "properties": {
        "offset": {
          "x": -1640,
          "y": 680
        },
        "input": "{{widgets.Save_count_txt.parsed.success}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF50aa5d7d13d9da3a25e2f29e09df4d24",
          "uuid": "3715ac84-269c-49b7-b75f-ac2ef6ab8e4f"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to success",
              "type": "equal_to",
              "arguments": [
                "{{widgets.Save_count_txt.parsed.success}}"
              ],
              "value": "True"
            }
          ],
          "next": "FFdc9c8ba5a7715641159a76d438724aa7",
          "uuid": "678ae7f2-aef0-4139-86a0-29a3245228c0"
        }
      ],
      "sid": "FF61b3fbdf3a9728e8c724835a6c3c0028"
    },
    {
      "type": "Message",
      "name": "send_message_2",
      "properties": {
        "offset": {
          "x": -2170,
          "y": 430
        },
        "body": "I didn't understand that. Please just enter a number.",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "sent",
          "conditions": [],
          "next": "FFef334fc11d8af4a6cb8c28468b848ead",
          "uuid": "d5c210a6-4822-41ed-a0a0-60d206a5b834"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "930ab6e3-c3b8-4e5d-b140-fb1b48a94ee8"
        }
      ],
      "sid": "FF50aa5d7d13d9da3a25e2f29e09df4d24"
    },
    {
      "type": "Gather",
      "name": "NumberOfBeds",
      "properties": {
        "offset": {
          "x": 750,
          "y": 130
        },
        "timeout": 5,
        "finish_on_key": "#",
        "stop_gather": true,
        "number_of_digits": null,
        "save_response_as": null,
        "say": "How many people are in the shelter right now? Please enter the number followed by the pound sign.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "hints": null,
        "gather_language": "en-US"
      },
      "transitions": [
        {
          "event": "keypress",
          "conditions": [],
          "next": "FF128c3d91ab3817b0cfef8f76ddb3e66c",
          "uuid": "5012dc8c-a242-4b58-8989-7bd076db84d8"
        },
        {
          "event": "speech",
          "conditions": [],
          "next": null,
          "uuid": "0ebdbc39-a1e9-4d00-ad54-f538d9828be9"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": "FF128c3d91ab3817b0cfef8f76ddb3e66c",
          "uuid": "ef7b058b-7e80-4f08-bad6-9769653a2e11"
        }
      ],
      "sid": "FFa1935002f30f4ef65c06ad6f1269c63d"
    },
    {
      "type": "Webhook",
      "name": "LogMachineError",
      "properties": {
        "offset": {
          "x": 1620,
          "y": -790
        },
        "method": "POST",
        "url": "http://shelter-caller.appspot.com/twilio/log_failed_call/",
        "body": null,
        "timeout": null,
        "parameters": [
          {
            "key": "error",
            "value": "answering machine"
          },
          {
            "key": "phone",
            "value": "{{widgets.Call.To}}"
          },
          {
            "key": "contactType",
            "value": "outgoing_call"
          },
          {
            "key": "shelterID",
            "value": "{{flow.data.id}}"
          }
        ],
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": null,
          "uuid": "6067d6c0-d7d1-4636-8de8-d267ea6eb09b"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "7c48c6af-3cf0-447e-b3f9-998c2773238a"
        }
      ],
      "sid": "FF578e7e5da281956ad82efef497eed0d0"
    },
    {
      "type": "Webhook",
      "name": "LogNoAnswer",
      "properties": {
        "offset": {
          "x": 1620,
          "y": -530
        },
        "method": "POST",
        "url": "http://shelter-caller.appspot.com/twilio/log_failed_call/",
        "body": null,
        "timeout": null,
        "parameters": [
          {
            "key": "error",
            "value": "Call Failed"
          },
          {
            "key": "phone",
            "value": "{{widgets.Call.To}}"
          },
          {
            "key": "contactType",
            "value": "outgoing_call"
          },
          {
            "key": "shelterID",
            "value": "{{flow.data.id}}"
          }
        ],
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": null,
          "uuid": "96fa72db-d8f3-4fec-9df4-9edb220ebb5f"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "789eebe5-b050-49be-96e4-75b510ed8429"
        }
      ],
      "sid": "FF723b129ed3ac41ef637eb0c34b695ee8"
    },
    {
      "type": "Branch",
      "name": "to_many_tries",
      "properties": {
        "offset": {
          "x": 1510,
          "y": 370
        },
        "input": "{{widgets.Collect.parsed.tries}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF393202c6967d408cd355f237c4e0143e",
          "uuid": "5cdb28aa-ceb3-4b65-86c5-89cca09ebf64"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value less_than 3",
              "type": "less_than",
              "arguments": [
                "{{widgets.Collect.parsed.tries}}"
              ],
              "value": "2"
            }
          ],
          "next": "FF6d4d58375f51236a73e50fce82a37842",
          "uuid": "507090b5-7ce9-4022-8060-6ff0a90d78b4"
        }
      ],
      "sid": "FF04f68c3abca96bc7cdaa974097cd029b"
    },
    {
      "type": "SayPlay",
      "name": "say_try_bak",
      "properties": {
        "offset": {
          "x": 1560,
          "y": 660
        },
        "say": "I'm sorry, I'm having trouble understanding. I'll try again later.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": null,
          "uuid": "0846a59a-8f91-441d-b084-911b2e174ff6"
        }
      ],
      "sid": "FF393202c6967d408cd355f237c4e0143e"
    },
    {
      "type": "Gather",
      "name": "ConfirmCount",
      "properties": {
        "offset": {
          "x": 390,
          "y": 1000
        },
        "timeout": 7,
        "finish_on_key": "#",
        "stop_gather": false,
        "number_of_digits": 1,
        "save_response_as": null,
        "say": "You entered {{widgets.Collect.parsed.count}}. If this is correct, press 1, otherwise press 9 to make a change.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "hints": null,
        "gather_language": "en-US"
      },
      "transitions": [
        {
          "event": "keypress",
          "conditions": [],
          "next": "FF536d80643a4a017661762701544d7a2b",
          "uuid": "fe541059-3e44-45af-9b5c-e4df2f7456fb"
        },
        {
          "event": "speech",
          "conditions": [],
          "next": null,
          "uuid": "dcef2fb1-08b8-4fb6-b2ff-72599b4ad0d3"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": "FF553253296b3a0692fa9e73c98e51c528",
          "uuid": "e2dc86c6-cf5f-46ce-a74f-629665d89a49"
        }
      ],
      "sid": "FF553253296b3a0692fa9e73c98e51c528"
    },
    {
      "type": "Branch",
      "name": "Split_1_or_9",
      "properties": {
        "offset": {
          "x": 60,
          "y": 370
        },
        "input": "{{widgets.ConfirmCount.Digits}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF553253296b3a0692fa9e73c98e51c528",
          "uuid": "0dfcb6b3-3614-462a-8bd5-5a8ade75a6f0"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 9",
              "type": "equal_to",
              "arguments": [
                "{{widgets.ConfirmCount.Digits}}"
              ],
              "value": "1"
            }
          ],
          "next": "FF08d5e6b50e862562eb726f9ec1691060",
          "uuid": "d9ff3a8e-095c-4d64-855a-9bac069aaf4b"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 9",
              "type": "equal_to",
              "arguments": [
                "{{widgets.ConfirmCount.Digits}}"
              ],
              "value": "9"
            }
          ],
          "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
          "uuid": "471f81cc-f934-4082-8920-884a5436531d"
        }
      ],
      "sid": "FF536d80643a4a017661762701544d7a2b"
    },
    {
      "type": "Webhook",
      "name": "validate_time_txt",
      "properties": {
        "offset": {
          "x": -1490,
          "y": -1000
        },
        "method": "GET",
        "url": "http://shelter-caller.appspot.com/twilio/validate_time/",
        "body": null,
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF0d1ddb0868085c128f3416f79665fa2c",
          "uuid": "f79127e6-fcb7-4f07-a18f-e29fe60a3ef4"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "221bb081-e259-4612-ae84-0f3de5e235ea"
        }
      ],
      "sid": "FF9e858a7a6a524755068ce740d4be32a8"
    },
    {
      "type": "Branch",
      "name": "open_txt",
      "properties": {
        "offset": {
          "x": -1480,
          "y": -770
        },
        "input": "{{widgets.validate_time_txt.parsed.open}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FFf35c2aa2474151ae6115d971aae29ae0",
          "uuid": "7b915eca-70b7-49c9-bcd8-4c7e98f7a87c"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to true",
              "type": "equal_to",
              "arguments": [
                "{{widgets.validate_time_txt.parsed.open}}"
              ],
              "value": "true"
            }
          ],
          "next": "FF738e5b761d09d89f0cc6fb87f08a71a8",
          "uuid": "220df4ed-8938-4168-9ff6-2f940fbdd68d"
        }
      ],
      "sid": "FF0d1ddb0868085c128f3416f79665fa2c"
    },
    {
      "type": "Message",
      "name": "closed_txt",
      "properties": {
        "offset": {
          "x": -2030,
          "y": -700
        },
        "body": "This service only accepts texts {{widgets.validate_time_txt.parsed.hours}}. Please try again during this time.",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "sent",
          "conditions": [],
          "next": null,
          "uuid": "a876c9f7-8898-4d2c-b493-9a275b098031"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "c31d424c-802b-4a6a-8ef4-e3c885921da7"
        }
      ],
      "sid": "FFf35c2aa2474151ae6115d971aae29ae0"
    },
    {
      "type": "Webhook",
      "name": "validate_time_voice",
      "properties": {
        "offset": {
          "x": -780,
          "y": -630
        },
        "method": "GET",
        "url": "http://shelter-caller.appspot.com/twilio/validate_time/",
        "body": null,
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/x-www-form-urlencoded;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF800b7b7d46a438c30a77a989118d42ab",
          "uuid": "708ccbc1-7c17-4876-8187-57eb1fa6d926"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "831b399f-5060-4795-9df5-32099a3dab94"
        }
      ],
      "sid": "FF2cea504b41c5188ff8dfa8c0ffd886c8"
    },
    {
      "type": "Branch",
      "name": "open_voice",
      "properties": {
        "offset": {
          "x": -280,
          "y": -620
        },
        "input": "{{widgets.validate_time_voice.parsed.open}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF5aef4f759335f3ac5a541af9e784535c",
          "uuid": "c3bff362-6178-4cad-af4c-ed3197e6c7bf"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to true",
              "type": "equal_to",
              "arguments": [
                "{{widgets.validate_time_voice.parsed.open}}"
              ],
              "value": "true"
            }
          ],
          "next": "FF6a0d2610d0eb653b13e350c51c30ccbf",
          "uuid": "7a5241ff-b447-49e6-ad16-ef39b79cd463"
        }
      ],
      "sid": "FF800b7b7d46a438c30a77a989118d42ab"
    },
    {
      "type": "SayPlay",
      "name": "closed_voice",
      "properties": {
        "offset": {
          "x": -790,
          "y": -320
        },
        "say": "Hello. This service only accepts input  {{widgets.validate_time_voice.parsed.spoken_hours}}. \n\nPlease call back during these hours.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": null,
          "uuid": "fddb525d-3c70-4e2e-b106-1ca3693abf6e"
        }
      ],
      "sid": "FF5aef4f759335f3ac5a541af9e784535c"
    },
    {
      "type": "SetVariables",
      "name": "shelter_id",
      "properties": {
        "offset": {
          "x": 580,
          "y": -880
        },
        "variables": [
          {
            "value": "{{flow.data.id}}",
            "key": "shelter_id"
          }
        ]
      },
      "transitions": [
        {
          "event": "next",
          "conditions": [],
          "next": "FF70e060531dc1c1d1ce8c9dff29736c57",
          "uuid": "2b766e9e-6419-424e-bb09-7ea6d2d9eb00"
        }
      ],
      "sid": "FF4bf88042a63554a51f9dae5669705fcc"
    },
    {
      "type": "SetVariables",
      "name": "Set_shelter_id_incoming",
      "properties": {
        "offset": {
          "x": -60,
          "y": 60
        },
        "variables": [
          {
            "value": "{{widgets.verify_id_voice.parsed.id}}",
            "key": "shelter_id",
            "index": "0"
          }
        ]
      },
      "transitions": [
        {
          "event": "next",
          "conditions": [],
          "next": "FFa1935002f30f4ef65c06ad6f1269c63d",
          "uuid": "ae41ca1c-c6da-4b95-9dbd-0a488504c633"
        }
      ],
      "sid": "FF18c57c42d940ae284f3669846abb4aaf"
    }
  ]
}